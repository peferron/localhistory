/* localhistory v1.0.0 | https://github.com/peferron/localhistory | License: MIT */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.localhistory={})}(this,function(e){function n(){if(!b)throw new Error("This browser does not support localhistory")}function t(){try{console.warn.apply(console,arguments)}catch(e){}}function r(e,n,t){if(t.maxEntries<1)throw new Error("Could not append entry, maxEntries is "+t.maxEntries);var r=void 0;try{r=c(e)}catch(i){y.consoleWarn("localhistory: could not load previous entries, resetting history",i.message),r=[]}!t.appendIfEqualToLast&&r.length&&o(n,r[r.length-1])||(r.push(n),a(e,r,t))}function o(e,n){return JSON.stringify(e)===JSON.stringify(n)}function a(e,n,t){for(n.length>t.maxEntries&&n.splice(0,n.length-t.maxEntries);;){var r=JSON.stringify(n),o=2*r.length;if(o>t.maxBytes){if(n.length<2)throw new Error("Could not append entry of length "+r.length+" "+("("+o+" bytes), maxBytes is "+t.maxBytes));i(n)}else try{return void(localStorage[e]=r)}catch(a){if(u(a)){if(n.length<2)throw new Error("Could not append entry of length "+r.length+", exceeds localStorage quota");i(n);continue}throw a}}}function i(e){e.splice(0,Math.ceil(e.length/2))}function u(e){return e&&(22===e.code||1014===e.code&&"NS_ERROR_DOM_QUOTA_REACHED"===e.name)}function c(e){var n=localStorage[e];if(!n)return[];var t=JSON.parse(n);if(!Array.isArray(t))throw new Error("Loaded entries are not an Array");return t}function f(e){localStorage.removeItem(e)}function l(e,n){return y.promise?new Promise(function(t,r){s(e,function(e,o){e?r(e):t(o),n&&n(e,o)})}):void s(e,n)}function s(e,n){var t=null,r=void 0;try{r=e()}catch(o){t=o}n&&n(t,r)}function p(e,n,t,r){var o="function"==typeof t?t:r,a=d(t&&"object"==typeof t?t:{});return l(function(){y.throwIfUnsupported(),E.append(e,n,a)},o)}function d(e){return isNaN(e.maxEntries)&&(e.maxEntries=100),isNaN(e.maxBytes)&&(e.maxBytes=1e5),e.hasOwnProperty("appendIfEqualToLast")||(e.appendIfEqualToLast=!0),e}function h(e,n){return l(function(){return y.throwIfUnsupported(),E.load(e)},n)}function g(e,n){return l(function(){y.throwIfUnsupported(),E.clear(e)},n)}var y=Object.defineProperties({},{supported:{get:function(){return b},configurable:!0,enumerable:!0},throwIfUnsupported:{get:function(){return n},configurable:!0,enumerable:!0},promise:{get:function(){return w},configurable:!0,enumerable:!0},consoleWarn:{get:function(){return t},configurable:!0,enumerable:!0}}),m=function(){var e="localhistory_support_"+Math.random(),n=""+Math.random(),t=!1;try{localStorage[e]=n,t=localStorage[e]===n}catch(r){}try{localStorage.removeItem(e)}catch(r){t=!1}return t}(),b=m&&"object"==typeof JSON&&"isArray"in Array,w="function"==typeof Promise,E=Object.defineProperties({},{append:{get:function(){return r},configurable:!0,enumerable:!0},load:{get:function(){return c},configurable:!0,enumerable:!0},clear:{get:function(){return f},configurable:!0,enumerable:!0}}),x=y.supported;e.supported=x,e.append=p,e.load=h,e.clear=g});
//# sourceMappingURL=localhistory.min.js.map