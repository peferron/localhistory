!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.localhistory={})}(this,function(e){function n(){if(!b)throw new Error("This browser does not support localhistory")}function r(){try{console.warn.apply(console,arguments)}catch(e){}}function t(e,n){if(n.maxRuns<1)throw new Error("Could not save run, maxRuns is "+n.maxRuns);var r=void 0;try{r=c()}catch(t){y.consoleWarn("localhistory: could not load previous runs, resetting history",t),r=[]}r.length&&o(e,r[r.length-1])||(r.push(e),u(r,n))}function o(e,n){return JSON.stringify(e)===JSON.stringify(n)}function u(e,n){for(e.length>n.maxRuns&&e.splice(0,e.length-n.maxRuns);;){var r=JSON.stringify(e),t=2*r.length;if(t>n.maxBytes){if(e.length<2)throw new Error("Could not save run of length "+r.length+" "+("("+t+" bytes), maxBytes is "+n.maxBytes));a(e)}else try{return void(localStorage[S]=r)}catch(o){if(i(o)){if(e.length<2)throw new Error("Could not save run of length "+r.length+", exceeds localStorage quota");a(e);continue}throw o}}}function a(e){e.splice(0,Math.ceil(e.length/2))}function i(e){return e&&(22===e.code||1014===e.code&&"NS_ERROR_DOM_QUOTA_REACHED"===e.name)}function c(){var e=localStorage[S];if(!e)return[];var n=JSON.parse(e);if(!Array.isArray(n))throw new Error("Loaded runs are not an Array");return n}function f(){localStorage.removeItem(S)}function s(e){e()}function l(e,n){var r=void 0===arguments[2]?s:arguments[2];return y.promise?new Promise(function(t,o){r(function(){g(e,function(e,r){e?o(e):t(r),n&&n(e,r)})})}):void r(function(){g(e,n)})}function g(e,n){var r=null,t=void 0;try{t=e()}catch(o){r=o}n&&n(r,t)}function h(e,n,r){var t="function"==typeof n?n:r,o=p("object"==typeof n?n:{});return l(function(){y.throwIfUnsupported(),x.save(e,o)},t,setTimeout)}function p(e){return isNaN(e.maxRuns)&&(e.maxRuns=100),isNaN(e.maxBytes)&&(e.maxBytes=1e5),e}function d(e){return l(function(){return y.throwIfUnsupported(),x.load()},e)}function m(e){return l(function(){y.throwIfUnsupported(),x.clear()},e)}var y=Object.defineProperties({},{supported:{get:function(){return b},configurable:!0,enumerable:!0},throwIfUnsupported:{get:function(){return n},configurable:!0,enumerable:!0},promise:{get:function(){return w},configurable:!0,enumerable:!0},consoleWarn:{get:function(){return r},configurable:!0,enumerable:!0}}),v=function(){var e="localhistory_support_Vo8yTd6aLS$A8huo9$e7",n=Math.random()+"";try{localStorage[e]=n;var r=localStorage[e]===n;return localStorage.removeItem(e),r}catch(t){return!1}}(),b=v&&"object"==typeof JSON&&"isArray"in Array,w="function"==typeof Promise,x=Object.defineProperties({},{save:{get:function(){return t},configurable:!0,enumerable:!0},load:{get:function(){return c},configurable:!0,enumerable:!0},clear:{get:function(){return f},configurable:!0,enumerable:!0}}),S="localhistory_runs_A*O%y21#Q1WSh^f09YO!",O=y.supported;e.supported=O,e.save=h,e.load=d,e.clear=m});
//# sourceMappingURL=localhistory.min.js.map