!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.localhistory={})}(this,function(e){function n(){if(!b)throw new Error("This browser does not support localhistory")}function r(){try{console.warn.apply(console,arguments)}catch(e){}}function t(e,n,r){if(r.maxEntries<1)throw new Error("Could not append entry, maxEntries is "+r.maxEntries);var t=void 0;try{t=c(e)}catch(a){y.consoleWarn("localhistory: could not load previous entries, resetting history",a.message),t=[]}t.length&&o(n,t[t.length-1])||(t.push(n),i(e,t,r))}function o(e,n){return JSON.stringify(e)===JSON.stringify(n)}function i(e,n,r){for(n.length>r.maxEntries&&n.splice(0,n.length-r.maxEntries);;){var t=JSON.stringify(n),o=2*t.length;if(o>r.maxBytes){if(n.length<2)throw new Error("Could not append entry of length "+t.length+" "+("("+o+" bytes), maxBytes is "+r.maxBytes));a(n)}else try{return void(localStorage[e]=t)}catch(i){if(u(i)){if(n.length<2)throw new Error("Could not append entry of length "+t.length+", exceeds localStorage quota");a(n);continue}throw i}}}function a(e){e.splice(0,Math.ceil(e.length/2))}function u(e){return e&&(22===e.code||1014===e.code&&"NS_ERROR_DOM_QUOTA_REACHED"===e.name)}function c(e){var n=localStorage[e];if(!n)return[];var r=JSON.parse(n);if(!Array.isArray(r))throw new Error("Loaded entries are not an Array");return r}function f(e){localStorage.removeItem(e)}function l(e,n){return y.promise?new Promise(function(r,t){s(e,function(e,o){e?t(e):r(o),n&&n(e,o)})}):void s(e,n)}function s(e,n){var r=null,t=void 0;try{t=e()}catch(o){r=o}n&&n(r,t)}function p(e,n,r,t){var o="function"==typeof r?r:t,i=d("object"==typeof r?r:{});return l(function(){y.throwIfUnsupported(),v.append(e,n,i)},o)}function d(e){return isNaN(e.maxEntries)&&(e.maxEntries=100),isNaN(e.maxBytes)&&(e.maxBytes=1e5),e}function g(e,n){return l(function(){return y.throwIfUnsupported(),v.load(e)},n)}function h(e,n){return l(function(){y.throwIfUnsupported(),v.clear(e)},n)}var y=Object.defineProperties({},{supported:{get:function(){return b},configurable:!0,enumerable:!0},throwIfUnsupported:{get:function(){return n},configurable:!0,enumerable:!0},promise:{get:function(){return w},configurable:!0,enumerable:!0},consoleWarn:{get:function(){return r},configurable:!0,enumerable:!0}}),m=function(){var e="localhistory_support_Vo8yTd6aLS$A8huo9$e7",n=Math.random()+"";try{localStorage[e]=n;var r=localStorage[e]===n;return localStorage.removeItem(e),r}catch(t){return!1}}(),b=m&&"object"==typeof JSON&&"isArray"in Array,w="function"==typeof Promise,v=Object.defineProperties({},{append:{get:function(){return t},configurable:!0,enumerable:!0},load:{get:function(){return c},configurable:!0,enumerable:!0},clear:{get:function(){return f},configurable:!0,enumerable:!0}}),x=y.supported;e.supported=x,e.append=p,e.load=g,e.clear=h});
//# sourceMappingURL=localhistory.min.js.map