{"version":3,"sources":["playbyplay.js"],"names":[],"mappings":"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","file":"playbyplay.js","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n    typeof define === 'function' && define.amd ? define(['exports'], factory) :\n    factory((global.playbyplay = {}))\n}(this, function (exports) { 'use strict';\n\n    const supportsLocalStorage = (() => {\n        const key = 'playbyplay_support_Vo8yTd6aLS$A8huo9$e7';\n        const value = Math.random() + '';\n\n        try {\n            localStorage[key] = value;\n            if (localStorage[key] !== value) {\n                return false;\n            }\n        } catch (e) {\n            return false;\n        }\n\n        return true;\n    })();\n\n    const supportsJSON = typeof window !== 'undefined' &&\n        'JSON' in window &&\n        'parse' in JSON &&\n        'stringify' in JSON;\n\n    const supportsIsArray = 'isArray' in Array;\n\n    function check() {\n        if (!supportsLocalStorage) {\n            throw new Error('localStorage is not supported');\n        }\n\n        if (!supportsJSON) {\n            throw new Error('JSON is not supported');\n        }\n\n        if (!supportsIsArray) {\n            throw new Error('Array.isArray is not supported');\n        }\n    }\n\n    var storage = {\n        get save () { return storage__save; },\n        get load () { return storage__load; },\n        get clear () { return storage__clear; }\n    };\n\n    const runsKey = 'playbyplay_runs_A*O%y21#Q1WSh^f09YO!';\n\n    // Max history size in bytes.\n    const maxBytes = 50000;\n\n    // Max length of the history string. Assumes 16 bits per character.\n    const maxLength = maxBytes * 8 / 16;\n\n    // Max runs in history.\n    const maxRuns = 200;\n\n    // Save\n\n    function storage__save(run) {\n        let runs;\n        try {\n            runs = storage__load();\n        } catch (err) {\n            runs = [];\n        }\n\n        if (runs.length && sameRun(run, runs[runs.length - 1])) {\n            return;\n        }\n\n        runs.push(run);\n        saveRuns(runs);\n    }\n\n    function sameRun(a, b) {\n        return JSON.stringify(a) === JSON.stringify(b);\n    }\n\n    function saveRuns(runs) {\n        if (runs.length > maxRuns) {\n            runs.splice(0, runs.length - maxRuns);\n        }\n\n        while (true) { // eslint-disable-line no-constant-condition\n            let runsStr = JSON.stringify(runs);\n\n            if (runsStr.length > maxLength) {\n                if (runs.length < 2) {\n                    throw new Error(`Could not save run of length ${runsStr.length}, ` +\n                        `the maximum length is ${maxLength}`);\n                }\n\n                removeFirstHalf(runs);\n                continue;\n            }\n\n            try {\n                localStorage[runsKey] = runsStr;\n                return;\n            } catch (err) {\n                if (isQuotaError(err)) {\n                    if (runs.length < 2) {\n                        throw new Error(`Could not save run of length ${runsStr.length}, ` +\n                            `exceeds localStorage quota`);\n                    }\n\n                    removeFirstHalf(runs);\n                    continue;\n                }\n\n                throw err;\n            }\n        }\n    }\n\n    function removeFirstHalf(arr) {\n        arr.splice(0, Math.ceil(arr.length / 2));\n    }\n\n    function isQuotaError(err) {\n        return err &&\n            (err.code === 22 ||\n             err.code === 1014 && err.name === 'NS_ERROR_DOM_QUOTA_REACHED');\n    }\n\n    // Load\n\n    function storage__load() {\n        const runsStr = localStorage[runsKey];\n        if (!runsStr) {\n            return [];\n        }\n\n        const runs = JSON.parse(runsStr);\n        if (!Array.isArray(runs)) {\n            throw new Error('Loaded runs are not an Array');\n        }\n\n        return runs;\n    }\n\n    // Clear\n\n    function storage__clear() {\n        localStorage.removeItem(runsKey);\n    }\n\n    function index__save(run, callback) {\n        setTimeout(() => {\n            try {\n                check();\n                storage.save(run);\n                callback(null);\n            } catch (err) {\n                callback(err);\n            }\n        }, 0);\n    }\n\n    function index__load(callback) {\n        try {\n            check();\n            const runs = storage.load();\n            callback(null, runs);\n        } catch (err) {\n            callback(err);\n        }\n    }\n\n    function index__clear(callback) {\n        try {\n            check();\n            storage.clear();\n            callback(null);\n        } catch (err) {\n            callback(err);\n        }\n    }\n\n    exports.save = index__save;\n    exports.load = index__load;\n    exports.clear = index__clear;\n\n}));\n"],"sourceRoot":"./"}